<div class="unit-content">
<body id="apex_database_sosl_learning_objectives"><a name="apex_database_sosl_learning_objectives"></a>
<div class="nested0">
<h2 class="helpHead2" id="Tdxn4tBK-heading1"><span class="ph" id="topic-title"><a name="topic-title"></a>Learning Objectives</span></h2>
<div class="body">
<div class="p" id="p2"><a name="p2"></a>After completing this unit, you'll be able to: <ul class="ul bulletList">
<li class="li">Describe the differences between SOSL and SOQL.</li>
<li class="li">Search for fields across multiple objects using SOSL queries.</li>
<li class="li">Execute SOSL queries by using the Query Editor in the Developer Console.</li>
</ul>
</div>
</div>
</div>
<div class="topic concept nested0" id="apex_database_sosl" lang="en-us" xml:lang="en-us" xmlns:xml="http://www.w3.org/XML/1998/namespace"><a name="apex_database_sosl"></a>
<h2 class="helpHead2" id="Tdxn4tBK-heading2"><span class="ph" id="topic-title"><a name="topic-title"></a>Write SOSL Queries</span></h2>
<div class="body conbody"><div class="shortdesc">Salesforce Object Search Language (SOSL) is a Salesforce search language that is used
    to perform text searches in records. Use SOSL to search fields across multiple standard and
    custom object records in Salesforce. SOSL is similar to Apache Lucene.</div>
<div class="section">
<p class="p">Adding SOSL queries to Apex is simple—you can embed SOSL queries directly in your
        Apex code. When SOSL is embedded in Apex, it is referred to as <dfn class="term">inline SOSL</dfn>.</p>
<p class="p">This is an example of a SOSL query that searches for accounts and contacts that have any
        fields with the word 'SFDC'.</p>
<div class="codeblock"><pre>List&lt;List&lt;SObject&gt;&gt; searchList = [FIND 'SFDC' IN ALL FIELDS 
                                      RETURNING Account(Name), Contact(FirstName,LastName)];</pre></div>
</div>
<div class="section"><h3 class="helpHead3" id="Tdxn4tBK-heading3">Differences and Similarities Between SOQL and SOSL</h3>
<p class="p">Like SOQL, SOSL allows you to search your organization’s records for specific
        information. Unlike SOQL, which can only query one standard or custom object at a time, a
        single SOSL query can search all objects.</p>
<p class="p">Another difference is that SOSL matches fields based on a word match while SOQL performs an
        exact match by default (when not using wildcards). For example, searching for 'Digital' in
        SOSL returns records whose field values are 'Digital' or 'The Digital Company', but SOQL
        returns only records with field values of 'Digital'.</p>
<p class="p">SOQL and SOSL are two separate languages with different syntax. Each language has a
        distinct use case:</p>
<ul class="ul bulletList">
<li class="li">Use SOQL to retrieve records for a single object.</li>
<li class="li">Use SOSL to search fields across multiple objects. SOSL queries can search most text
          fields on an object.</li>
</ul>
</div>
<div class="section"><h3 class="helpHead3" id="Tdxn4tBK-heading4">Prerequisites</h3>
<p class="p">Some queries in this unit expect the org to have accounts and contacts. If you haven’t
        created the sample data in the SOQL unit, create sample data in this unit. Otherwise, you
        can skip creating the sample data in this section.</p>
<ol class="ol enumList">
<li class="li">In the Developer Console, open the Execute Anonymous window from the
            <strong class="ph uicontrol">Debug</strong> menu.</li>
<li class="li">Insert the below snippet in the window and click <strong class="ph uicontrol">Execute</strong>.</li>
</ol>
<div class="codeblock"><pre>// Add account and related contact
Account acct = new Account(
    Name='SFDC Computing',
    Phone='(415)555-1212',
    NumberOfEmployees=50,
    BillingCity='San Francisco');
insert acct;

// Once the account is inserted, the sObject will be 
// populated with an ID.
// Get this ID.
ID acctID = acct.ID;

// Add a contact to this account.
Contact con = new Contact(
    FirstName='Carol',
    LastName='Ruiz',
    Phone='(415)555-1212',
    Department='Wingo',
    AccountId=acctID);
insert con;

// Add account with no contact
Account acct2 = new Account(
    Name='The SFDC Query Man',
    Phone='(310)555-1213',
    NumberOfEmployees=50,
    BillingCity='Los Angeles',
    Description='Expert in wing technologies.');
insert acct2;
</pre></div>
</div>
<div class="section"><h3 class="helpHead3" id="Tdxn4tBK-heading5">Using the Query Editor</h3>
<p class="p">The Developer Console provides the Query Editor console, which enables you to run SOSL
        queries and view results. The Query Editor provides a quick way to inspect the database. It
        is a good way to test your SOSL queries before adding them to your Apex code. When you use
        the Query Editor, you need to supply only the SOSL statement without the Apex code that
        surrounds it.</p>
<p class="p">Let’s try running the following SOSL example: </p>
<ol class="ol enumList">
<li class="li">In the Developer Console, click the <em class="ph i">Query Editor </em> tab.</li>
<li class="li">Copy and paste the following into the first box under Query Editor, and then click
            <strong class="ph uicontrol">Execute</strong>.</li>
</ol>
<div class="codeblock"><pre>FIND {Wingo} IN ALL FIELDS RETURNING Account(Name), Contact(FirstName,LastName,Department)</pre></div>
<p class="p">All account and contact records in your org that satisfy the criteria will display in the
        Query Results section as rows with fields. The results are grouped in tabs for each object
        (account or contact). The SOSL query returns records that have fields whose values matches
        Wingo. Based on our sample data, only the contact has a field with the value Wingo, so this
        contact is returned..</p>
<div class="box message info"><div class="inner"><div class="bd"><div class="media"><img alt="Note" class="img mtm" src="https://res.cloudinary.com/hy4kyit2a/image/upload/doc/trailhead/en-usb473bb5ea1b7e61dfb07e6a7e547de6b.gif"/><div class="mediaBd"><h4 class="mbs">Note</h4><p>The search query in the Query Editor and the API must be enclosed within curly brackets
          (<samp>{Wingo}</samp>). In contrast, in Apex the search query is enclosed within
        single quotes (<samp>'Wingo'</samp>).</p></div></div></div></div></div>
</div>
<div class="section"><h3 class="helpHead3" id="Tdxn4tBK-heading6">Basic SOSL Syntax</h3>
<div class="p">SOSL allows you to specify the following search criteria:<ul class="ul bulletList">
<li class="li">Text expression (single word or a phrase) to search for</li>
<li class="li">Scope of fields to search</li>
<li class="li">List of objects and fields to retrieve</li>
<li class="li">Conditions for selecting rows in the source objects</li>
</ul>
</div>
<p class="p">This is the syntax of a basic SOSL query:</p>
<div class="codeblock"><pre>FIND 'SearchQuery' [IN SearchGroup] [RETURNING ObjectsAndFields]</pre></div>
<p class="p"><var class="keyword varname">SearchQuery</var> is the text to search for (a single word or a phrase).
        Search terms can be grouped with logical operators (AND, OR) and parentheses. Also, search
        terms can include wildcard characters (*, ?). The * wildcard matches zero or more characters
        at the middle or end of the search term. The ? wildcard matches only one character at the
        middle or end of the search term.</p>
<p class="p">Text searches are case-insensitive. For example, searching for <samp>Customer</samp>, <samp>customer</samp>, or <samp>CUSTOMER</samp> all return the same results.</p>
<p class="p"><var class="keyword varname">SearchGroup</var> is optional. It is the scope of the fields to search. If not
        specified, the default search scope is all fields. <var class="keyword varname">SearchGroup</var> can take
        one of the following values. </p>
<ul class="ul bulletList">
<li class="li"><samp>ALL FIELDS</samp></li>
<li class="li"><samp>NAME FIELDS</samp></li>
<li class="li"><samp>EMAIL FIELDS</samp></li>
<li class="li"><samp>PHONE FIELDS</samp></li>
<li class="li"><samp>SIDEBAR FIELDS</samp></li>
</ul>
<p class="p"><var class="keyword varname">ObjectsAndFields</var> is optional. It is the information to return in the
        search result—a list of one or more sObjects and, within each sObject, list of one or
        more fields, with optional values to filter against. If not specified, the search results
        contain the IDs of all objects found. </p>
</div>
<div class="section"><h3 class="helpHead3" id="Tdxn4tBK-heading7"><span class="ph" id="i1423040"><a name="i1423040"></a>Single Words and Phrases</span></h3>
<p class="p">A <var class="keyword varname">SearchQuery</var> contains two types of text:</p>
<ul class="ul bulletList">
<li class="li"><strong class="ph b">Single Word</strong>— single word, such as <samp>test</samp> or <samp>hello</samp>. Words in the <samp>SearchQuery</samp> are delimited by spaces, punctuation, and changes
          from letters to digits (and vice-versa). Words are always case insensitive. </li>
<li class="li"><strong class="ph b">Phrase</strong>— collection of words and spaces surrounded by double quotes such as
            <samp>"john smith"</samp>. Multiple words can be combined together
          with logic and grouping operators to form a more complex query.</li>
</ul>
</div>
<div class="section"><h3 class="helpHead3" id="Tdxn4tBK-heading8">Search Examples</h3>
<p class="p">To learn about how SOSL search works, let’s play with different search strings and see what
        the output is based on our sample data. This table lists various example search strings and
        the SOSL search results.</p>
<div class="data colSort"><table class="featureTable sort_table" summary="">
<thead align="left" class="thead sorted">
<tr>
<th class="featureTableHeader " id="d21829e307">Search in all fields for:</th>
<th class="featureTableHeader " id="d21829e310">Search Description</th>
<th class="featureTableHeader " id="d21829e313">Matched Records and Fields</th>
</tr>
</thead>
<tbody class="tbody">
<tr>
<td class="entry" data-title="Search in all fields for:" headers="d21829e307">The Query</td>
<td class="entry" data-title="Search Description" headers="d21829e310">This search returns all records whose fields contain both words: The and Query,
                in any location of the text. The order of words in the search term doesn’t
                matter.</td>
<td class="entry" data-title="Matched Records and Fields" headers="d21829e313">Account: The SFDC Query Man (Name field matched)</td>
</tr>
<tr>
<td class="entry" data-title="Search in all fields for:" headers="d21829e307">Wingo OR Man</td>
<td class="entry" data-title="Search Description" headers="d21829e310">This search uses the OR logical operator. It returns records with fields
                containing the Wingo word or records with fields containing the SFDC word.</td>
<td class="entry" data-title="Matched Records and Fields" headers="d21829e313">Contact: Carol Ruiz, Department: 'Wingo'<p class="p">Account: The SFDC Query Man (Name
                  field matched)</p>
</td>
</tr>
<tr>
<td class="entry" data-title="Search in all fields for:" headers="d21829e307">1212</td>
<td class="entry" data-title="Search Description" headers="d21829e310">This search returns all records whose fields contain the 1212 word. Phone
                fields that end with -1212 are matched because 1212 is considered a word when
                delimited by the dash.</td>
<td class="entry" data-title="Matched Records and Fields" headers="d21829e313">Account: The SFDC Query Man, Phone: '(415)555-1212'<p class="p">Contact: Carol Ruiz,
                  Phone: '(415)555-1212'</p>
</td>
</tr>
<tr>
<td class="entry" data-title="Search in all fields for:" headers="d21829e307">wing*</td>
<td class="entry" data-title="Search Description" headers="d21829e310">This is a wildcard search. This search returns all records that have a field
                value starting with wing.</td>
<td class="entry" data-title="Matched Records and Fields" headers="d21829e313">Contact: Maria Ruiz, Department: 'Wingo'<p class="p">Account: The SFDC Query Man,
                  Description: 'Expert in wing technologies.'</p>
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="section"><h3 class="helpHead3" id="Tdxn4tBK-heading9">SOSL Apex Example</h3>
<p class="p">This example shows how to run a SOSL query in Apex. This SOSL query combines two search
        terms by using the OR logical operator—it searches for Wingo or SFDC in any field.
        This example returns all the sample accounts because they each have a field containing one
        of the words. The SOSL search results are returned in a list of lists. Each list contains an
        array of the returned records. In this case, the list has two elements. At index 0, the list
        contains the array of accounts. At index 1, the list contains the array of contacts.</p>
<p class="p">Execute this snippet in the Execute Anonymous window of the Developer Console. Next,
        inspect the debug log to verify that all records are returned.</p>
<div class="codeblock"><pre>List&lt;List&lt;sObject&gt;&gt; searchList = [FIND 'Wingo OR SFDC' IN ALL FIELDS 
                   RETURNING Account(Name),Contact(FirstName,LastName,Department)];
Account[] searchAccounts = (Account[])searchList[0];
Contact[] searchContacts = (Contact[])searchList[1];

System.debug('Found the following accounts.');
for (Account a : searchAccounts) {
    System.debug(a.Name);
}

System.debug('Found the following contacts.');
for (Contact c : searchContacts) {
    System.debug(c.LastName + ', ' + c.FirstName);
}</pre></div>
</div>
<div class="section"><h3 class="helpHead3" id="Tdxn4tBK-heading10">Tell Me More...</h3>
<p class="p">You can filter, reorder, and limit the returned results of a SOSL query. Because SOSL
        queries can return multiple sObjects, those filters are applied within each sObject inside
        the RETURNING clause.</p>
<p class="p">You can filter SOSL results by adding conditions in the WHERE clause for an object. For
        example, this results in only accounts whose industry is Apparel to be returned: <samp>RETURNING Account(Name, Industry WHERE Industry='Apparel')</samp>
</p>
<p class="p">Likewise, ordering results for one sObject is supported by adding ORDER BY for an object.
        For example this causes the returned accounts to be ordered by the Name field:
          <samp>RETURNING Account(Name, Industry ORDER BY Name)</samp>.</p>
<p class="p">The number of returned records can be limited to a subset of records. This example limits
        the returned accounts to 10 only: <samp>RETURNING Account(Name, Industry LIMIT
          10)</samp></p>
</div>
</div>
</div>
<div class="topic nested0" id="apex_database_sosl_resources" lang="en-us" xml:lang="en-us" xmlns:xml="http://www.w3.org/XML/1998/namespace"><a name="apex_database_sosl_resources"></a>
<h2 class="helpHead2" id="Tdxn4tBK-heading11">
<span class="ph" id="topic-title"><a name="topic-title"></a>Resources</span>
</h2>
<div class="body">
<ul class="ul bulletList">
<li class="li Documentation">
<a class="xref" href="https://developer.salesforce.com/docs/atlas.en-us.206.0.soql_sosl.meta/soql_sosl/" target="_blank" title="HTML (New Window)">Force.com SOQL and SOSL
                    Reference</a>
</li>
</ul>
<div class="box message info"><div class="inner"><div class="bd"><div class="media"><img class="img mtm" src="https://res.cloudinary.com/hy4kyit2a/image/upload/doc/trailhead/en-usc504a262d3ae7aa180918396b7c09a71.png"/><div class="mediaBd"><p>Remember, this module is meant for
            Salesforce Classic. When you launch your hands-on org, <a class="xref" href="https://help.salesforce.com/articleView?id=lex_switching_uis.htm&amp;language=en_US" target="_blank">switch to Salesforce Classic</a> to complete this
            challenge.</p></div></div></div></div></div>
</div>
</div>
</body></div>