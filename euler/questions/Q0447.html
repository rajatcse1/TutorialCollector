<div id="content">
<div class="print" style="text-align:center;"><img alt="projecteuler.net" src="images/print_page_logo.png" style="border:none;"/></div>
<h2>Retractions C</h2><div id="problem_info"><h3>Problem 447 <span class="info noprint" style="float:right;"><img src="images/icon_info.png" style="width:18px;opacity:0.7;"/><span style="left:-400px;width:450px;font-size:80%;">Published on Saturday, 16th November 2013, 10:00 pm; Solved by 170;<br/>Difficulty rating: 95%</span></span></h3></div>
<div class="problem_content" role="problem">
<p>
For every integer n&gt;1, the family of functions f<sub>n,a,b</sub>  is defined 
by f<sub>n,a,b</sub>(<var>x</var>)≡a<var>x</var>+b mod n for a,b,<var>x</var> integer and  0&lt;a&lt;n, 0≤b&lt;n, 0≤<var>x</var>&lt;n.<br/>
We will call f<sub>n,a,b</sub> a <i>retraction</i> if f<sub>n,a,b</sub>(f<sub>n,a,b</sub>(<var>x</var>))≡f<sub>n,a,b</sub>(<var>x</var>) mod n for every 0≤<var>x</var>&lt;n.<br/>
Let R(n) be the number of retractions for n.
</p>
<p>
F(N)=∑R(n) for 2≤n≤N.<br/>
F(10<sup>7</sup>)≡638042271 (mod 1 000 000 007).
</p>
<p> 
Find F(10<sup>14</sup>) (mod 1 000 000 007).
</p>
</div><br/>
<br/></div>