<div id="content">
<div class="print" style="text-align:center;"><img alt="projecteuler.net" src="images/print_page_logo.png" style="border:none;"/></div>
<h2>McCarthy 91 function</h2><div id="problem_info"><h3>Problem 555 <span class="info noprint" style="float:right;"><img src="images/icon_info.png" style="width:18px;opacity:0.7;"/><span style="left:-400px;width:450px;font-size:80%;">Published on Sunday, 10th April 2016, 04:00 am; Solved by 407;<br/>Difficulty rating: 30%</span></span></h3></div>
<div class="problem_content" role="problem">
<p>
The McCarthy 91 function is defined as follows:
$$
M_{91}(n) = 
    \begin{cases}
        n - 10 &amp; \text{if } n &gt; 100 \\
        M_{91}(M_{91}(n+11)) &amp; \text{if } 0 \leq n \leq 100
    \end{cases}
$$
</p>
<p>
We can generalize this definition by abstracting away the constants into new variables:

$$
M_{m,k,s}(n) = 
    \begin{cases}
        n - s &amp; \text{if } n &gt; m \\
        M_{m,k,s}(M_{m,k,s}(n+k)) &amp; \text{if } 0 \leq n \leq m
    \end{cases}
$$
</p>
<p>
This way, we have $M_{91} = M_{100,11,10}$.
</p>
<p>
Let $F_{m,k,s}$ be the set of fixed points of $M_{m,k,s}$. That is, 

$$F_{m,k,s}= \left\{ n \in \mathbb{N} \, | \, M_{m,k,s}(n) = n \right\}$$
</p>
<p>
For example, the only fixed point of $M_{91}$ is $n = 91$. In other words, $F_{100,11,10}= \{91\}$.
</p>
<p>
Now, define $SF(m,k,s)$ as the sum of the elements in $F_{m,k,s}$ and let $S(p,m) = \displaystyle \sum_{1 \leq s &lt; k \leq p}{SF(m,k,s)}$.
</p>
<p>
For example, $S(10, 10) = 225$ and $S(1000, 1000)=208724467$.
</p>
<p>
Find $S(10^6, 10^6)$.
</p>
</div><br/>
<br/></div>